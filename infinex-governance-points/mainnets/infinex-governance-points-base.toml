name = "infinex-gp"
version = "0.1.1"
preset = "StW"
description = "Infinex Governance Points Deployments"

[setting.OWNER]
defaultValue = "0x88485E0486600C3259b72695FDa2201Eb0E53356"
description = "The Council multisig"

[setting.STWPOINTS]
defaultValue = "<%= parseEther('33000000') %>"
description = "The amount of STW points to be distributed"

[provision.InfinexGovernancePoints]
options.SALT = "GP_0_1_1"
options.OWNER = "0x88485E0486600C3259b72695FDa2201Eb0E53356"
options.CONTRACT_FACTORY = "0x3596ee6E58eecED63Fc021C901c7E415333156D3" 
options.INFINEX_FORWARDER = "0xd8Ee97b984Abc8E4eD864833FdE6FA5BACd1b10C"
options.USDC = "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913" 
options.REWARDS_DURATION =  "604800" 
options.SOLANA_MULTIPLIER = "<%= parseEther('1') %>"
source = "infinex-governance-points:latest@stw"

# ---------- Initialise GP Contracts  ---------- #

# [invoke.upgrade]
# target = ["InfinexGovernancePoints.GovernancePointsInitialProxy"]
# func = "upgradeTo"
# args = ["<%= imports.InfinexGovernancePoints.contracts.GovernancePointsImplementation.address %>"]
# depends = ["provision.InfinexGovernancePoints"]
# factory.CoreProxy.abiOf = ["InfinexGovernancePoints.GovernancePointsImplementation"]
# factory.CoreProxy.event = "Upgraded"
# factory.CoreProxy.arg = 0
# factory.CoreProxy.highlight = true

[invoke.GovernancePointsProxyInitialize]
target = ["InfinexGovernancePoints.GovernancePointsProxy"]
func = "initialize"
args = ["<%= settings.OWNER %>"]
depends = ["provision.InfinexGovernancePoints"]

# ---------- Setting Post deployment parameters  ---------- #

[invoke.attachSTWCampaign]
target = ["InfinexGovernancePoints.GovernancePointsProxy"]
func = "addAuthorisedMinter"
args = [ "<%= imports.InfinexGovernancePoints.contracts.StWStakingRewards.address %>" ]
from = "<%= settings.OWNER %>"
depends = ["invoke.GovernancePointsProxyInitialize"]

[invoke.StWStakingRewardsNotifyRewardAmount]
target = ["InfinexGovernancePoints.StWStakingRewards"]
func = "notifyRewardAmount"
args = [ "<%= settings.STWPOINTS %>" ]
depends = ["invoke.attachSTWCampaign"]